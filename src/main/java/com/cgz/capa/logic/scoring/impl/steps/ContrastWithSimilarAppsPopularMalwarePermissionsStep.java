package com.cgz.capa.logic.scoring.impl.steps;

import com.cgz.capa.logic.services.ApplicationPropertiesService;
import com.cgz.capa.model.Permission;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.SortedMap;

/**
 * Created by czarek on 01/02/15.
 */
public class ContrastWithSimilarAppsPopularMalwarePermissionsStep extends ContrastWithSimilarAppsStep {

    private final ScorePopularMalwarePermissionsDelegate scorePopularMalwarePermissionsDelegate;

    public ContrastWithSimilarAppsPopularMalwarePermissionsStep(double rarePermissionBracket, double uniquePermissionBracket, double uniquePermissionPenaltyRatio, ScorePopularMalwarePermissionsDelegate scorePopularMalwarePermissionsDelegate) {
        super(rarePermissionBracket, uniquePermissionBracket, uniquePermissionPenaltyRatio);
        this.scorePopularMalwarePermissionsDelegate =  scorePopularMalwarePermissionsDelegate;
    }

    @Override
    protected int evaluateRisk(Permission permission, StringBuilder messageBuilder) {
        return scorePopularMalwarePermissionsDelegate.evaluateRisk(permission, messageBuilder);
    }
}
